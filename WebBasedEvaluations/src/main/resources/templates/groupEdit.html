<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="ISO-8859-1">
	<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
	crossorigin="anonymous">
	<title>Edit Groups</title>


	<script th:inline="javascript">
		function radioClicked(questID, option1, option2) {
			//alert("ID: " + questID + " OPTION: " + option);
			var insertDiv = document.getElementById(questID + option1 + option2);
			if (insertDiv.innerHTML.trim() == "") {
				insertDiv.innerHTML = "<input type=\"hidden\" name=\"role\" value=\"" + questID + "\">";

			} else {
				insertDiv.innerHTML = "";
			}

		}


		function radioClicked2(questID, option1) {
			//alert("ID: " + questID + " OPTION: " + option);
			var insertDiv = document.getElementById(questID + 'sync');

			insertDiv.innerHTML = "<input type=\"hidden\" name=\"issync\" value=\"" + option1 + "\">";


		}

		function radioClicked3(questID, option1) {
			//alert("ID: " + questID + " OPTION: " + option);
			var insertDiv = document.getElementById(questID + 'prev');

			insertDiv.innerHTML = "<input type=\"hidden\" name=\"isprev\" value=\"" + option1 + "\">";

		}
	</script>
	
	<!-- Include jQuery -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<!-- Include DataTables CSS and JS -->
	<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.21/css/jquery.dataTables.css">
	<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.js"></script>

	<style>
	.status-item {
		display: flex;
		align-items: center;
		gap: 4px;
	}
	</style>
</head>

<body>
	<nav class="navbar navbar-dark bg-secondary  justify-content-center ">
		<div class="btn-group ">
			<a th:href="@{/adminGroups}"><button class="btn btn-outline-light btn-sm" type="button">Back</button></a>
		</div>
	</nav>

	<div class="container  mt-5">
		<!-- Modal -->
			<div class="modal fade" id="legendModal" tabindex="-1" aria-labelledby="legendModalLabel" aria-hidden="true">
  				<div class="modal-dialog">
    				<div class="modal-content">
      					<div class="modal-header">
        					<h5 class="modal-title" id="legendModalLabel">Legend</h5>
        					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      					</div>
      				<div class="modal-body">
        				<div>
        					<div class="status-item">
								<svg xmlns="http://www.w3.org/2000/svg" width="16"
						 			 height="16" fill="currentColor" class="bi bi-check-circle-fill"
					 	 			 viewBox="0 0 16 16" style="color: green">
  					 				 <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z" />
								</svg> : <strong>Sync</strong> Evaluation cannot be conducted independently of other evaluations.
							</div>
							<div class="status-item">
								<svg xmlns="http://www.w3.org/2000/svg" width="16"
						 			 height="16" fill="currentColor" class="bi bi-x-circle-fill"
					 	 			 viewBox="0 0 16 16" style="color: red;">
  					 				 <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293z" />
								</svg> : <strong>Async</strong> Evaluation can be conducted independently of other evaluations.
							</div>
							<p>
								<strong>Preview:</strong> Users have the capability to preview the evaluation before completing it.
							</p>
						</div>
      				</div>
      				
      				<div class="modal-footer">
        				<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      				</div>
    			</div>
  			</div>
		</div>
	
		<div th:switch="${ansr}">
			<div class="row">
				<div class="col">
					<div th:case="fail">
						<div class="col">
							<div class="alert alert-danger alert-dismissible fade show" role="alert">
								<span th:utext="'<Strong>ERROR:&nbsp</strong>'+ ${mess}"></span>
								<button type="button" class="btn-close" data-bs-dismiss="alert"
									aria-label="Close"></button>
							</div>
						</div>
					</div>
					<div th:case="pass">
						<div class="col">
							<div class="alert alert-success alert-dismissible fade show" role="alert">
								<span th:utext="'<Strong>SUCCESS:&nbsp</strong>'+ ${mess}"></span>
								<button type="button" class="btn-close" data-bs-dismiss="alert"
									aria-label="Close"></button>
							</div>
						</div>
					</div>
					<div class="row">

						<div class="row">
							<div class="col">
								<nav class="navbar navbar-light bg-light">
									<h4 th:text="'Manage: '+${group.groupName} + ' (' + ${group.year} + ')'"><b></b>
									</h4>
								</nav>
								<form action='#' th:action="@{/changegroup{id}(id=${group.id})}" th:object="${group}"
									method="post">

									<label for="groupName1">Group Name:</label>
									<input type="text" th:field="*{groupName}" id="groupName1" placeholder="Group Name">
									<span th:if="${#fields.hasErrors('groupName')}" th:errors="*{groupName}"></span>

									<label for="groupNumber">Number:</label>
									<input type="text" th:field="*{number}" id="groupNumber" placeholder="Group Number">
									<span th:if="${#fields.hasErrors('number')}" th:errors="*{number}"></span>

									<label for="groupYear1">Year:</label>
									<input type="text" th:field="*{year}" id="groupYear1" placeholder="Group Year">
									<span th:if="${#fields.hasErrors('year')}" th:errors="*{year}"></span>

									<input type="submit" class="btn btn-outline-success btn-sm" value="Update Group">
								</form>
							</div>
						</div>
						<hr>

						<div class="row">
							<div class="col">
<!-- 
								<form th:action="@{/editgroupsearch/{id}(id=${group.id})}" method="get">
									&nbsp
									<div align="left">
										<input type="text" name="searchKey" th:value="${keyword}"
											placeholder="Search Employee Name" size="65"> </input>

										<button type="submit" class="btn btn-outline-primary">Search</button>

										<div align="left">
											<select id="department" name="department">
												<option th:value="All" th:text="All"></option>
												<option th:each="dept : ${deptList}" th:value="${dept.name}"
													th:text="${dept.name}"></option>
											</select>
										</div>
								</form>
								-->
							</div>

							<div class="container  mt-5" style="margin: 0px; width: max-content;">
								<div>
									<div style="display: flex; justify-content: space-between;">
										<div
											style="white-space: nowrap; width: 100%; padding-bottom: 20px;">
											<h4>
												<b>Add Employee to Group</b>
											</h4>
											<hr>
											<table style="border: 1px solid black;" id="employeeTable"
												class="table" align="center">
												<thead>
													<tr>
														<th>Name</th>
														<th>Email</th>
														<th>Department</th>
														<th>Action</th>
													</tr>
												</thead>
												<tbody>
													<tr th:each="user : ${userlist}"
														style="vertical-align: baseline; height: 30px">
														<td style="padding: 5px; margin: 2px; width: 100px;"
															th:text="${user.name}"></td>
														<td th:text="${user.email}"></td>
														<td th:text="${user.departmentName}"></td>
														<td><span style="padding-right: 5px">
																<button class="btn btn-outline-success" type="button"
																	th:onclick="|window.location.href='@{/editgroup/{id}/{uid}(id=${group.id} , uid=${user.id})}'|">Add</button>
														</span></td>
													</tr>
												</tbody>
											</table>
										</div>
										<div
											style="display: flex; flex-direction: column; white-space: nowrap; width: 100%">
											<div class="scrollable"
												style="width: fit-content; padding-left: 20px; padding-bottom: 20px;">
												<h4>
													<b>Group Employees</b>
												</h4>
												<hr>
												<table style="border: 1px solid black;"
													id="groupEmployeesTable" class="table" align="center">
													<thead>
														<tr>
															<th>Name</th>
															<th>Group</th>
															<th>Department</th>
															<th>Edit</th>
															<th>Move</th>
															<th>Remove</th>
														</tr>
													</thead>
													<tbody>
														<tr th:each="rev : ${group.reviewees}"
															style="vertical-align: baseline">
															<td th:text="${rev.user.name}"></td>
															<td th:text="${group.groupName}"></td>
															<td th:text="${rev.user.departmentName}"></td>

															<td><span style="padding-right: 2px">
																	<button class="btn btn-outline-success" type="button"
																		th:onclick="|window.location.href='@{/edit/{id}/{userId} (id=${group.id} , userId=${rev.user.id})}'|">Edit</button>

															</span></td>
															<td><span style="padding-right: 2px">
																	<button class="btn btn-outline-primary" type="button"
																		th:onclick="|window.location.href='@{/editgroupmoveuser/{id}/{uid}(id=${group.id}, uid=${rev.user.id})}'|">Move</button>
															</span></td>
															<td><span style="padding-right: 2px">
																	<button class="btn btn-outline-danger" type="button"
																		th:onclick="|window.location.href='@{/group/deleteUser/{id}/{gid} (gid=${group.id} , id=${rev.user.id})}'|">Remove</button>
															</span></td>
														</tr>
													</tbody>
												</table>
											</div>
											</div>
											</div>

												<div class="collapse" id="collapseExample">
													<div class="card card-body" style="margin-left: 0px;">
														<div class="status-item">
															<svg xmlns="http://www.w3.org/2000/svg" width="16"
						 										 height="16" fill="currentColor" class="bi bi-check-circle-fill"
					 	 									 	 viewBox="0 0 16 16" style="color: green">
  					 											 <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z" />
															</svg> : <i>Sync</i>, evaluation cannot be conducted independently of other evaluations.
														</div>
														<div class="status-item">
															<svg xmlns="http://www.w3.org/2000/svg" width="16"
						 										 height="16" fill="currentColor" class="bi bi-x-circle-fill"
					 	 										 viewBox="0 0 16 16" style="color: red;">
  					 											 <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293z" />
															</svg> : <i>Async</i>, evaluation can be conducted independently of other evaluations.
														</div>
														<p>
															<strong>Preview:</strong> Users have the capability to preview the evaluation before completing it.
														</p>
													</div>
												</div>
											
											<div
												style="flex: 1; padding-top:20px; margin-right: 120px; white-space: nowrap; width: 100%; ">
												<h4>
													<b>Group Evaluators</b>
												</h4>
												<hr>
												<table style="border: 1px solid black;"
													id="groupEvaluatorsTable" class="table" align="center">
													<thead>
														<tr>
															<th>Name</th>
															<th>Level</th>
															<th><button type="button" class="btn btn-sm btn-dark" data-bs-toggle="modal" data-bs-target="#legendModal">
  																Synchronicity
																</button></th>
															<th>Preview Available</th>
															<th>Deadline</th>
															<th>Edit</th>
															<th>Remove</th>
														</tr>
													</thead>
													<tbody>
														<tr th:each="eval : ${evalList}"
															style="vertical-align: baseline; height: 30px">
															<td th:text="${eval.user.name}"></td>
															<td th:text="${eval.level.name}"></td>

															
															<td th:if="${eval.sync == true}">
																<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-check-circle-fill" viewBox="0 0 16 16" style="color: green; margin-left: 45px;">
  																	<path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/>
																</svg>
															</td>
															
															<td th:if="${eval.sync == false}">
																<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-circle-fill" viewBox="0 0 16 16" style="color: red; margin-left: 45px;">
  																	<path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293z"/>
																</svg>
															</td>
															
															<td>
																<div th:text="${eval.preview ? 'Yes' : 'No'}" style="margin-left: 65px;"></div>
															</td>


															<td
																th:text="${#dates.format(eval.deadline, 'yyyy-MM-dd')}">
															</td>



															<td><span style="padding-right: 2px">
																	<button class="btn btn-outline-success" type="button"
																		th:onclick="|window.location.href='@{/getchangeEvaluator/{id}/{eid} (id=${group.id} , eid=${eval.id})}'|">Edit</button>

															</span></td>
															<td><span style="padding-right: 2px">
																	<button class="btn btn-outline-danger" type="button"
																		th:onclick="|window.location.href='@{/removeEvaluator/{id}/{eid} (id=${group.id} , eid=${eval.id})}'|">Remove</button>

															</span></td>

														</tr>

													</tbody>
												</table>
												<div th:if="${#lists.size(evalList)< 4}">
													<button class="btn btn-outline-success" type="button"
														th:onclick="|window.location.href='@{/getAddEvaluator/{id} (id=${group.id})}'|">Add
														Evaluator</button>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
							<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
								integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
								crossorigin="anonymous"></script>
						</div>
					</div>
				</div>
		
		<script>
		$(document).ready(function() {
		    // Initialize DataTables for the first table
		    $('#employeeTable').DataTable({
		        "paging": true,
		        "ordering": true,
		        "info": true,
		        "searching": true
		    }); 
		    
	        // Initialize DataTables for the Group Employees Table
	        $('#groupEmployeesTable').DataTable({
	            "paging": true,
	            "ordering": true,
	            "info": true,
	            "searching": true
	        });

	        // Initialize DataTables for the Group Evaluators Table
	        $('#groupEvaluatorsTable').DataTable({
	            "paging": true,
	            "ordering": true,
	            "info": true,
	            "searching": true
	        });
		});
	</script>
				
				
</body>




</html>